---
/**
 * 太阳系动画组件 - 精简版
 */
---

<div class="solar-system-wrapper">
    <!-- 简化星空 -->
    <div class="stars"></div>
    
    <!-- 太阳系 -->
    <div class="solar-system" id="solar-system">
        <div class="sun" id="sun" title="点击重置"></div>
        
        <div class="orbit" data-orbit="mercury"></div>
        <div class="planet mercury" data-planet="mercury"></div>
        
        <div class="orbit" data-orbit="venus"></div>
        <div class="planet venus" data-planet="venus"></div>
        
        <div class="orbit" data-orbit="earth"></div>
        <div class="planet earth" data-planet="earth"></div>
        
        <div class="orbit" data-orbit="mars"></div>
        <div class="planet mars" data-planet="mars"></div>
        
        <div class="orbit" data-orbit="jupiter"></div>
        <div class="planet jupiter" data-planet="jupiter"></div>
        
        <div class="orbit" data-orbit="saturn"></div>
        <div class="planet saturn" data-planet="saturn"></div>
    </div>
</div>

<style>
.solar-system-wrapper {
    width: 100%;
    height: 300px;
    position: relative;
    overflow: hidden;
    background: linear-gradient(to bottom, rgba(0,0,20,0.2), rgba(0,0,40,0.5));
    border-radius: 1rem;
    margin-bottom: 1rem;
}

.stars {
    position: absolute;
    inset: 0;
    background-image: 
        radial-gradient(1px 1px at 20px 30px, white, transparent),
        radial-gradient(1px 1px at 80px 60px, white, transparent),
        radial-gradient(1px 1px at 140px 90px, white, transparent),
        radial-gradient(1px 1px at 200px 40px, white, transparent);
    background-size: 250px 150px;
}

.solar-system {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 500px;
    height: 500px;
}

.sun {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 36px;
    height: 36px;
    background: radial-gradient(circle, #fff700, #ff9500, #ff5500);
    border-radius: 50%;
    box-shadow: 0 0 30px #ff9500;
    cursor: pointer;
    z-index: 10;
}

.orbit {
    position: absolute;
    top: 50%;
    left: 50%;
    border: 1px dashed rgba(255,255,255,0.12);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
}

[data-orbit="mercury"] { width: 60px; height: 60px; }
[data-orbit="venus"] { width: 90px; height: 90px; }
[data-orbit="earth"] { width: 130px; height: 130px; }
[data-orbit="mars"] { width: 170px; height: 170px; }
[data-orbit="jupiter"] { width: 220px; height: 220px; }
[data-orbit="saturn"] { width: 280px; height: 280px; }

.planet {
    position: absolute;
    border-radius: 50%;
    cursor: grab;
    z-index: 5;
    touch-action: none;
}

.planet.dragging { cursor: grabbing; box-shadow: 0 0 15px rgba(255,255,255,0.8); }

.mercury { width: 6px; height: 6px; background: #b5b5b5; }
.venus { width: 10px; height: 10px; background: #ffd699; }
.earth { width: 12px; height: 12px; background: #6b93d6; }
.mars { width: 8px; height: 8px; background: #e27b58; }
.jupiter { width: 20px; height: 20px; background: linear-gradient(135deg, #d4a574, #c88b3a); }
.saturn { width: 16px; height: 16px; background: #f4d59e; }

@media (max-width: 768px) {
    .solar-system-wrapper { height: 220px; }
    .solar-system { width: 340px; height: 340px; }
    .sun { width: 28px; height: 28px; }
    [data-orbit="mercury"] { width: 45px; height: 45px; }
    [data-orbit="venus"] { width: 65px; height: 65px; }
    [data-orbit="earth"] { width: 90px; height: 90px; }
    [data-orbit="mars"] { width: 115px; height: 115px; }
    [data-orbit="jupiter"] { width: 145px; height: 145px; }
    [data-orbit="saturn"] { width: 180px; height: 180px; }
    .mercury { width: 5px; height: 5px; }
    .venus { width: 8px; height: 8px; }
    .earth { width: 10px; height: 10px; }
    .mars { width: 6px; height: 6px; }
    .jupiter { width: 16px; height: 16px; }
    .saturn { width: 13px; height: 13px; }
}
</style>

<script>
(function() {
    const ss = document.getElementById('solar-system');
    if (!ss) return;
    
    const mobile = window.innerWidth <= 768;
    const size = mobile ? 340 : 500;
    const cx = size / 2, cy = size / 2;
    
    const cfg = mobile ? {
        mercury: { r: 22.5, s: 0.025 },
        venus: { r: 32.5, s: 0.018 },
        earth: { r: 45, s: 0.012 },
        mars: { r: 57.5, s: 0.009 },
        jupiter: { r: 72.5, s: 0.006 },
        saturn: { r: 90, s: 0.004 }
    } : {
        mercury: { r: 30, s: 0.025 },
        venus: { r: 45, s: 0.018 },
        earth: { r: 65, s: 0.012 },
        mars: { r: 85, s: 0.009 },
        jupiter: { r: 110, s: 0.006 },
        saturn: { r: 140, s: 0.004 }
    };
    
    // 初始化角度
    Object.keys(cfg).forEach(k => cfg[k].a = Math.random() * Math.PI * 2);
    
    let drag = null;
    
    function pos(el, c) {
        el.style.left = (cx + Math.cos(c.a) * c.r - el.offsetWidth / 2) + 'px';
        el.style.top = (cy + Math.sin(c.a) * c.r - el.offsetHeight / 2) + 'px';
    }
    
    function orbit(n, r) {
        const o = ss.querySelector(`[data-orbit="${n}"]`);
        if (o) { o.style.width = r * 2 + 'px'; o.style.height = r * 2 + 'px'; }
    }
    
    const planets = ss.querySelectorAll('.planet');
    
    function animate() {
        planets.forEach(p => {
            const n = p.dataset.planet, c = cfg[n];
            if (p !== drag) { c.a += c.s; pos(p, c); }
        });
        requestAnimationFrame(animate);
    }
    
    function getXY(e) {
        const rect = ss.getBoundingClientRect();
        const t = e.touches ? e.touches[0] : e;
        return { x: t.clientX - rect.left - rect.width / 2, y: t.clientY - rect.top - rect.height / 2 };
    }
    
    function start(e, p) {
        e.preventDefault();
        drag = p;
        p.classList.add('dragging');
    }
    
    function move(e) {
        if (!drag) return;
        e.preventDefault();
        const xy = getXY(e), n = drag.dataset.planet, c = cfg[n];
        const max = mobile ? 90 : 140;
        c.r = Math.max(15, Math.min(max, Math.sqrt(xy.x * xy.x + xy.y * xy.y)));
        c.a = Math.atan2(xy.y, xy.x);
        pos(drag, c);
        orbit(n, c.r);
    }
    
    function end() {
        if (drag) { drag.classList.remove('dragging'); drag = null; }
    }
    
    planets.forEach(p => {
        p.addEventListener('mousedown', e => start(e, p));
        p.addEventListener('touchstart', e => start(e, p), { passive: false });
    });
    
    document.addEventListener('mousemove', move);
    document.addEventListener('touchmove', move, { passive: false });
    document.addEventListener('mouseup', end);
    document.addEventListener('touchend', end);
    
    // 重置
    const defR = mobile ? { mercury: 22.5, venus: 32.5, earth: 45, mars: 57.5, jupiter: 72.5, saturn: 90 }
                        : { mercury: 30, venus: 45, earth: 65, mars: 85, jupiter: 110, saturn: 140 };
    
    document.getElementById('sun')?.addEventListener('click', () => {
        Object.keys(defR).forEach(n => { cfg[n].r = defR[n]; orbit(n, defR[n]); });
    });
    
    // 初始化
    planets.forEach(p => { const n = p.dataset.planet; pos(p, cfg[n]); orbit(n, cfg[n].r); });
    animate();
})();
</script>
