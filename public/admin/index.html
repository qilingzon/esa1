<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>å†…å®¹ç®¡ç†</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    #quick-login-panel {
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      padding: 40px;
      max-width: 500px;
      width: 90%;
      margin: 20px;
    }
    
    h1 {
      margin: 0 0 10px 0;
      font-size: 28px;
      color: #333;
      text-align: center;
    }
    
    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }
    
    .section {
      margin-bottom: 25px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
    }
    
    .section-title {
      font-size: 16px;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    input[type="password"],
    input[type="text"] {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      font-size: 14px;
      box-sizing: border-box;
      transition: border-color 0.3s;
    }
    
    input:focus {
      outline: none;
      border-color: #667eea;
    }
    
    button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      margin-top: 10px;
    }
    
    .btn-primary {
      background: #667eea;
      color: white;
    }
    
    .btn-primary:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    
    .btn-secondary {
      background: #28a745;
      color: white;
    }
    
    .btn-secondary:hover {
      background: #218838;
    }
    
    .btn-link {
      background: transparent;
      color: #667eea;
      text-decoration: underline;
      padding: 8px;
    }
    
    .error {
      color: #dc3545;
      font-size: 13px;
      margin-top: 8px;
      display: none;
    }
    
    .success {
      color: #28a745;
      font-size: 13px;
      margin-top: 8px;
      display: none;
    }
    
    .steps {
      background: rgba(102, 126, 234, 0.1);
      padding: 15px;
      border-radius: 6px;
      font-size: 13px;
      margin-top: 15px;
      display: none;
    }
    
    .steps div {
      margin: 5px 0;
    }
    
    code {
      background: rgba(0,0,0,0.1);
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
    }
    
    #cms-container {
      display: none;
    }
    
    .loading {
      text-align: center;
      padding: 20px;
      color: #666;
    }
  </style>
</head>
<body>
  <div id="quick-login-panel">
    <h1>ğŸš€ åšå®¢åå°</h1>
    <div class="subtitle">å¿«é€Ÿç™»å½•åˆ°å†…å®¹ç®¡ç†ç³»ç»Ÿ</div>
    
    <!-- ä¸€é”®åˆ›å»º Token -->
    <div class="section">
      <div class="section-title">ğŸ“ é¦–æ¬¡ä½¿ç”¨ï¼Ÿåˆ›å»º GitHub Token</div>
      <button class="btn-secondary" onclick="createToken()">æ‰“å¼€ GitHub åˆ›å»º Token</button>
      <button class="btn-link" onclick="toggleSteps()">æŸ¥çœ‹è¯¦ç»†æ­¥éª¤</button>
      <div id="steps" class="steps">
        <div style="font-weight: bold; margin-bottom: 8px;">ğŸ“‹ ç®€å•3æ­¥ï¼š</div>
        <div>1ï¸âƒ£ åœ¨æ‰“å¼€çš„é¡µé¢ä¸­ï¼ŒNote å¡«å†™ï¼š<code>Blog CMS</code></div>
        <div>2ï¸âƒ£ å‹¾é€‰æƒé™ï¼š<code>repo</code> å’Œ <code>gist</code></div>
        <div>3ï¸âƒ£ ç‚¹å‡»åº•éƒ¨ç»¿è‰²æŒ‰é’®ç”Ÿæˆï¼Œç„¶åå¤åˆ¶ Token ç²˜è´´åˆ°ä¸‹æ–¹</div>
      </div>
    </div>
    
    <!-- Token ç™»å½• -->
    <div class="section">
      <div class="section-title">ğŸ”‘ ä½¿ç”¨ GitHub Token ç™»å½•</div>
      <input type="password" id="token-input" placeholder="ç²˜è´´ä½ çš„ GitHub Token" />
      <button class="btn-primary" onclick="loginWithToken()">ç™»å½•</button>
      <div id="token-error" class="error"></div>
      <div id="token-success" class="success"></div>
    </div>
  </div>
  
  <!-- CMS å®¹å™¨ -->
  <div id="cms-container">
    <div class="loading">æ­£åœ¨åŠ è½½å†…å®¹ç®¡ç†ç³»ç»Ÿ...</div>
  </div>
  
  <script src="https://unpkg.com/@sveltia/cms/dist/sveltia-cms.js" type="module"></script>
  <script>
    function createToken() {
      const url = 'https://github.com/settings/tokens/new?' + new URLSearchParams({
        description: 'Blog CMS - ' + new Date().toLocaleDateString(),
        scopes: 'repo,gist'
      }).toString();
      window.open(url, '_blank');
      document.getElementById('steps').style.display = 'block';
    }
    
    function toggleSteps() {
      const steps = document.getElementById('steps');
      steps.style.display = steps.style.display === 'none' ? 'block' : 'none';
    }
    
    async function loginWithToken() {
      const token = document.getElementById('token-input').value.trim();
      const errorDiv = document.getElementById('token-error');
      const successDiv = document.getElementById('token-success');
      
      errorDiv.style.display = 'none';
      successDiv.style.display = 'none';
      
      if (!token) {
        errorDiv.textContent = 'è¯·è¾“å…¥ GitHub Token';
        errorDiv.style.display = 'block';
        return;
      }
      
      // éªŒè¯ Token
      try {
        const response = await fetch('https://api.github.com/user', {
          headers: {
            'Authorization': `token ${token}`
          }
        });
        
        if (!response.ok) {
          errorDiv.textContent = 'Token æ— æ•ˆï¼Œè¯·æ£€æŸ¥åé‡è¯•';
          errorDiv.style.display = 'block';
          return;
        }
        
        // Token æœ‰æ•ˆï¼Œä¿å­˜å¹¶åŠ è½½ CMS
        localStorage.setItem('netlifycms-github-token', token);
        successDiv.textContent = 'âœ“ ç™»å½•æˆåŠŸï¼æ­£åœ¨åŠ è½½ç®¡ç†ç³»ç»Ÿ...';
        successDiv.style.display = 'block';
        
        // éšè—ç™»å½•é¢æ¿ï¼Œæ˜¾ç¤º CMS
        setTimeout(() => {
          document.getElementById('quick-login-panel').style.display = 'none';
          document.getElementById('cms-container').style.display = 'block';
          
          // è§¦å‘ CMS åŠ è½½
          window.location.reload();
        }, 1000);
        
      } catch (error) {
        errorDiv.textContent = 'ç½‘ç»œé”™è¯¯ï¼š' + error.message;
        errorDiv.style.display = 'block';
      }
    }
    
    // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
    window.addEventListener('DOMContentLoaded', () => {
      const token = localStorage.getItem('netlifycms-github-token');
      if (token) {
        // å·²æœ‰ Tokenï¼Œç›´æ¥æ˜¾ç¤º CMS
        document.getElementById('quick-login-panel').style.display = 'none';
        document.getElementById('cms-container').style.display = 'block';
      }
    });
    
    // ç›‘å¬å›è½¦é”®
    document.getElementById('token-input').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        loginWithToken();
      }
    });
  </script>
</body>
</html>
